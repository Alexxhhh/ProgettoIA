```html
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avventura nel Tempio Labirintico</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --primary-color: #8a0303;
            --secondary-color: #4d4d4d;
            --disabled-color: #333;
            --font-family: 'Georgia', serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-family);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        #game-wrapper {
            display: flex;
            border: 2px solid var(--secondary-color);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
            max-width: 1000px;
            width: 100%;
        }

        #sidebar {
            background-color: #111;
            padding: 20px;
            width: 200px;
            border-right: 2px solid var(--secondary-color);
            flex-shrink: 0;
        }

        #sidebar h2 {
            color: var(--primary-color);
            border-bottom: 1px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-top: 0;
        }

        #sidebar ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #sidebar li {
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        #main-content {
            padding: 20px;
            flex-grow: 1;
            text-align: center;
        }

        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--secondary-color);
            margin-bottom: 15px;
        }

        #room-name {
            margin: 0;
            font-size: 2em;
            color: var(--primary-color);
        }

        #lives {
            font-size: 2em;
            color: var(--primary-color);
            letter-spacing: 2px;
        }

        #message-area {
            min-height: 24px;
            font-style: italic;
            color: #ffd700;
            font-size: 1.1em;
        }

        #room-image {
            width: 600px;
            height: 400px;
            object-fit: cover;
            border: 2px solid var(--secondary-color);
            margin-bottom: 15px;
        }

        #room-description {
            font-size: 1.2em;
            line-height: 1.6;
            min-height: 50px;
        }

        #puzzle-container, #movement-container {
            margin-top: 20px;
        }

        .game-btn {
            background-color: var(--secondary-color);
            color: var(--text-color);
            border: 1px solid #666;
            padding: 10px 20px;
            font-family: var(--font-family);
            font-size: 1em;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s, transform 0.1s;
        }

        .game-btn:hover:not(:disabled) {
            background-color: #666;
            transform: translateY(-2px);
        }

        .game-btn:disabled {
            background-color: var(--disabled-color);
            color: #777;
            cursor: not-allowed;
            border-color: #444;
        }

        #puzzle-input {
            background-color: #222;
            color: var(--text-color);
            border: 1px solid var(--secondary-color);
            padding: 10px;
            font-size: 1em;
            width: 250px;
        }

        .end-screen {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .end-screen h1 {
            font-size: 3em;
            color: var(--primary-color);
        }
    </style>
</head>
<body>

    <div id="game-wrapper">
        <div id="sidebar">
            <h2>Inventario</h2>
            <ul id="item-list"></ul>
            <h2>Chiavi</h2>
            <ul id="key-list"></ul>
        </div>
        <div id="main-content">
            <div id="header">
                <h1 id="room-name"></h1>
                <div id="lives"></div>
            </div>
            <p id="message-area"></p>
            <img id="room-image" src="" alt="Immagine della stanza" width="600" height="400">
            <p id="room-description"></p>

            <div id="puzzle-container" style="display: none;">
                <p id="puzzle-question"></p>
                <input type="text" id="puzzle-input" placeholder="Scrivi la tua risposta...">
                <button id="submit-btn" class="game-btn">Invia</button>
            </div>

            <div id="movement-container">
                <button id="n-btn" class="game-btn" data-dir="n">Nord</button><br>
                <button id="w-btn" class="game-btn" data-dir="w">Ovest</button>
                <button id="e-btn" class="game-btn" data-dir="e">Est</button><br>
                <button id="s-btn" class="game-btn" data-dir="s">Sud</button>
            </div>
        </div>
    </div>

    <div id="victory-screen" class="end-screen">
        <h1>Congratulazioni! Hai trovato il tesoro!</h1>
        <button class="game-btn" onclick="location.reload()">Ricomincia</button>
    </div>

    <div id="game-over-screen" class="end-screen">
        <h1>Game Over! Sei rimasto senza vite.</h1>
        <button class="game-btn" onclick="location.reload()">Ricomincia</button>
    </div>

    <script>
        const gameData = {
            room1: {
                id: 'room1',
                name: 'Entrata del tempio',
                description: 'Ti trovi di fronte a un\'imponente porta di pietra, l\'ingresso di un antico tempio avvolto dalle ombre.',
                image: 'https://cdn.pixabay.com/photo/2016/11/29/02/28/door-1866833_960_720.jpg',
                connections: { n: 'room2', e: 'room13', s: 'room12' }
            },
            room2: {
                id: 'room2',
                name: 'Stanza buia',
                description: 'La stanza è buia e umida. Senti il fruscio di innumerevoli ali sopra di te: il soffitto è coperto di pipistrelli.',
                image: 'https://cdn.pixabay.com/photo/2017/09/08/03/23/digital-art-2727845_960_720.jpg',
                connections: { e: 'room3', s: 'room1' },
                puzzle: {
                    type: 'item',
                    question: 'La stanza è piena di pipistrelli, che oggetto intendi usare per attraversarla?',
                    answer: 'Torcia'
                }
            },
            room3: {
                id: 'room3',
                name: 'Stanza con chiave',
                description: 'Al centro della stanza, un piedistallo di pietra è illuminato da un singolo raggio di luce. Sopra, brilla una chiave.',
                image: 'https://cdn.pixabay.com/photo/2018/02/13/22/24/key-3152186_960_720.jpg',
                connections: { e: 'room4', w: 'room2' },
                keyToFind: 'k4'
            },
            room4: {
                id: 'room4',
                name: 'Stanza della saggezza',
                description: 'Il pavimento di questa stanza circolare è coperto da un sottile strato di sabbia fine, illuminata da una luce inspiegabile.',
                image: 'https://cdn.pixabay.com/photo/2017/05/16/21/24/sand-2319343_960_720.jpg',
                connections: { e: 'room5', s: 'room14', w: 'room3' },
                keyLock: { e: 'k1' },
                puzzle: {
                    type: 'riddle',
                    question: 'Mi trovi nel presente, ma non posso essere toccato. Passo silenzioso, nessuno mi vede arrivare. Posso guarire o distruggere. Chi sono?',
                    answer: 'Tempo'
                }
            },
            room5: {
                id: 'room5',
                name: 'Stanza del gas',
                description: 'Appena entri, senti un sibilo e un gas violaceo inizia a riempire la stanza da fessure nelle pareti.',
                image: 'https://cdn.pixabay.com/photo/2019/10/13/19/49/magical-4547165_960_720.jpg',
                connections: { e: 'room6', s: 'room15', w: 'room4' },
                keyLock: { s: 'k1', w: 'k1' },
                puzzle: {
                    type: 'item',
                    question: 'Hai azionato una trappola e la stanza si sta riempiendo di gas! Che oggetto vuoi usare?',
                    answer: 'Panno_bagnato'
                }
            },
            room6: {
                id: 'room6',
                name: 'Fontana',
                description: 'Una stanza tranquilla. Al centro, una fontana zampilla acqua cristallina, il cui suono echeggia dolcemente.',
                image: 'https://cdn.pixabay.com/photo/2016/11/21/13/58/architecture-1845448_960_720.jpg',
                connections: { s: 'room7', w: 'room5' }
            },
            room7: {
                id: 'room7',
                name: 'Stanza dei fratelli',
                description: 'Quattro imponenti statue maschili sono disposte ai quattro angoli della stanza, i loro volti di pietra sembrano osservarti.',
                image: 'https://cdn.pixabay.com/photo/2017/07/27/13/59/buddha-2545512_960_720.jpg',
                connections: { n: 'room6', s: 'room8', w: 'room15' },
                keyLock: { w: 'k3' },
                puzzle: {
                    type: 'riddle',
                    question: 'Fratelli corrono insieme, nessuno lascia mai il proprio cammino. A volte sono calmi, a volte in guerra, ma sempre si inseguono all\'infinito.',
                    answer: 'Stagioni'
                }
            },
            room8: {
                id: 'room8',
                name: 'Stanza con chiave',
                description: 'Al centro della stanza, un piedistallo di pietra è illuminato da un singolo raggio di luce. Sopra, brilla una chiave.',
                image: 'https://cdn.pixabay.com/photo/2018/02/13/22/24/key-3152186_960_720.jpg',
                connections: { n: 'room7', w: 'room9' },
                keyToFind: 'k3'
            },
            room9: {
                id: 'room9',
                name: 'Sedia',
                description: 'Una stanza spoglia e silenziosa, con nient\'altro che una singola sedia di legno al centro. Sembra un\'attesa infinita.',
                image: 'https://cdn.pixabay.com/photo/2017/08/06/05/25/chair-2589721_960_720.jpg',
                connections: { n: 'room15', e: 'room8', w: 'room10' },
                keyLock: { n: 'k2', w: 'k4' }
            },
            room10: {
                id: 'room10',
                name: 'Stanza dei buchi',
                description: 'Un corridoio stretto. Le pareti sono costellate di piccoli fori scuri. Senti un leggero click provenire dall\'interno.',
                image: 'https://cdn.pixabay.com/photo/2016/03/04/19/36/corridor-1236424_960_720.jpg',
                connections: { n: 'room14', e: 'room9', w: 'room11' },
                keyLock: { e: 'k4' },
                puzzle: {
                    type: 'item',
                    question: 'La stanza è piena di buchi sulle pareti. Che oggetto vuoi usare per proseguire?',
                    answer: 'Scudo'
                }
            },
            room11: {
                id: 'room11',
                name: 'Stanza con chiave',
                description: 'Al centro della stanza, un piedistallo di pietra è illuminato da un singolo raggio di luce. Sopra, brilla una chiave.',
                image: 'https://cdn.pixabay.com/photo/2018/02/13/22/24/key-3152186_960_720.jpg',
                connections: { e: 'room10', w: 'room13' },
                keyToFind: 'k1'
            },
            room12: {
                id: 'room12',
                name: 'Stanza misteriosa',
                description: 'L\'aria è pesante e piena di polvere. Antichi geroglifici coprono le pareti, ma sono quasi illeggibili.',
                image: 'https://cdn.pixabay.com/photo/2016/11/22/19/15/dark-1850120_960_720.jpg',
                connections: { n: 'room1', e: 'room14' },
                puzzle: {
                    type: 'riddle',
                    question: 'Ho occhi ma non posso vedere, una bocca ma non posso parlare, una forma umana ma non lo sono. Chi sono?',
                    answer: 'Statua'
                }
            },
            room13: {
                id: 'room13',
                name: 'Stanza opaca',
                description: 'Una stanza innaturalmente scura. La luce della tua torcia sembra essere assorbita dalle pareti stesse.',
                image: 'https://cdn.pixabay.com/photo/2017/02/15/18/54/dungeon-2069709_960_720.jpg',
                connections: { e: 'room14', s: 'room11', w: 'room1' },
                puzzle: {
                    type: 'riddle',
                    question: 'Più passa il tempo, più divento grande. Vivo dove la luce non osa entrare. Un giorno conquisterò anche l\'universo. Cosa sono?',
                    answer: 'Oscurità'
                }
            },
            room14: {
                id: 'room14',
                name: 'Stanza con chiave',
                description: 'Al centro della stanza, un piedistallo di pietra è illuminato da un singolo raggio di luce. Sopra, brilla una chiave.',
                image: 'https://cdn.pixabay.com/photo/2018/02/13/22/24/key-3152186_960_720.jpg',
                connections: { n: 'room4', e: 'room10', s: 'room12', w: 'room13' },
                keyToFind: 'k2'
            },
            room15: {
                id: 'room15',
                name: 'Stanza dell\'acqua',
                description: 'Le porte si chiudono dietro di te! L\'acqua inizia a salire rapidamente da grate sul pavimento. Vedi una leva arrugginita quasi sommersa.',
                image: 'https://cdn.pixabay.com/photo/2016/11/29/06/13/ancient-1867758_960_720.jpg',
                connections: { n: 'room5', e: 'room7', s: 'room9', w: 'room16' },
                keyLock: { n: 'k1', e: 'k3', s: 'k2' },
                puzzle: {
                    type: 'item',
                    question: 'Le porte si sono chiuse e la stanza si sta riempiendo d\'acqua! Vedi una leva quasi sommersa, che oggetto vuoi usare?',
                    answer: 'Asta_di_ferro'
                }
            },
            room16: {
                id: 'room16',
                name: 'Anticamera del tesoro',
                description: 'Sei di fronte a un\'ultima, grande porta. Un\'iscrizione enigmatica è incisa sopra di essa. Senti che questa è la prova finale.',
                image: 'https://cdn.pixabay.com/photo/2019/11/21/11/19/egypt-4642422_960_720.jpg',
                connections: { e: 'room15', w: 'room17' },
                puzzle: {
                    type: 'riddle',
                    question: 'Chi è che al mattino cammina con 4 zampe, a mezzogiorno con 2 e la sera con 3?',
                    answer: 'Uomo',
                    singleTry: true
                }
            },
            room17: {
                id: 'room17',
                name: 'Stanza del tesoro',
                description: 'Ce l\'hai fatta! La stanza brilla della luce riflessa da innumerevoli monete d\'oro, gemme e antichi manufatti.',
                image: 'https://cdn.pixabay.com/photo/2018/03/21/17/30/treasure-3247295_960_720.jpg',
                connections: {}
            }
        };

        const player = {
            currentRoom: 'room1',
            lives: 3,
            inventory: ['Torcia', 'Panno_bagnato', 'Scudo', 'Asta_di_ferro'],
            keys: [],
            solvedPuzzles: [],
            gameOver: false
        };

        // DOM Elements
        const roomNameEl = document.getElementById('room-name');
        const livesEl = document.getElementById('lives');
        const messageAreaEl = document.getElementById('message-area');
        const roomImageEl = document.getElementById('room-image');
        const roomDescriptionEl = document.getElementById('room-description');
        const puzzleContainerEl = document.getElementById('puzzle-container');
        const puzzleQuestionEl = document.getElementById('puzzle-question');
        const puzzleInputEl = document.getElementById('puzzle-input');
        const submitBtn = document.getElementById('submit-btn');
        const movementContainerEl = document.getElementById('movement-container');
        const moveButtons = document.querySelectorAll('#movement-container .game-btn');
        const itemListEl = document.getElementById('item-list');
        const keyListEl = document.getElementById('key-list');
        const gameWrapperEl = document.getElementById('game-wrapper');
        const victoryScreenEl = document.getElementById('victory-screen');
        const gameOverScreenEl = document.getElementById('game-over-screen');

        function updateUI() {
            // Update lives
            livesEl.textContent = '♥'.repeat(player.lives);

            // Update inventory
            itemListEl.innerHTML = '';
            player.inventory.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item.replace(/_/g, ' ');
                itemListEl.appendChild(li);
            });

            // Update keys
            keyListEl.innerHTML = '';
            player.keys.forEach(key => {
                const li = document.createElement('li');
                li.textContent = `Chiave ${key.toUpperCase()}`;
                keyListEl.appendChild(li);
            });
        }

        function renderRoom(roomId) {
            if (player.gameOver) return;

            player.currentRoom = roomId;
            const room = gameData[roomId];

            if (roomId === 'room17') {
                triggerVictory();
                return;
            }

            // Update room details
            roomNameEl.textContent = room.name;
            roomImageEl.src = room.image;
            roomDescriptionEl.textContent = room.description;
            
            // Clear message area after a short delay
            setTimeout(() => { messageAreaEl.textContent = ''; }, 3000);

            // Check for keys
            if (room.keyToFind && !player.keys.includes(room.keyToFind)) {
                collectKey(room.keyToFind);
            }

            // Check for puzzles
            if (room.puzzle && !player.solvedPuzzles.includes(roomId)) {
                renderPuzzle(room);
            } else {
                renderMovement(room);
            }
            
            updateUI();
        }

        function renderMovement(room) {
            puzzleContainerEl.style.display = 'none';
            movementContainerEl.style.display = 'block';

            const directions = ['n', 's', 'e', 'w'];
            directions.forEach(dir => {
                const btn = document.getElementById(`${dir}-btn`);
                if (room.connections[dir]) {
                    btn.style.visibility = 'visible';
                    const requiredKey = room.keyLock ? room.keyLock[dir] : null;
                    if (requiredKey && !player.keys.includes(requiredKey)) {
                        btn.disabled = true;
                        btn.title = `Richiede Chiave ${requiredKey.toUpperCase()}`;
                    } else {
                        btn.disabled = false;
                        btn.title = '';
                    }
                } else {
                    btn.style.visibility = 'hidden';
                }
            });
        }

        function renderPuzzle(room) {
            movementContainerEl.style.display = 'none';
            puzzleContainerEl.style.display = 'block';
            puzzleQuestionEl.textContent = room.puzzle.question;
            puzzleInputEl.value = '';
            puzzleInputEl.focus();
        }

        function collectKey(keyId) {
            player.keys.push(keyId);
            messageAreaEl.textContent = 'Hai trovato una chiave!';
            updateUI();
        }

        function loseLife() {
            if (player.gameOver) return;
            player.lives--;
            updateUI();
            if (player.lives <= 0) {
                triggerGameOver();
            }
        }

        function handleSubmitPuzzle() {
            if (player.gameOver) return;

            const room = gameData[player.currentRoom];
            const userAnswer = puzzleInputEl.value.trim();
            const correctAnswer = room.puzzle.answer;

            // Note: The lore implies case-sensitive "exact name" matching.
            if (userAnswer === correctAnswer) {
                messageAreaEl.textContent = 'Risposta corretta! La via è libera.';
                player.solvedPuzzles.push(player.currentRoom);
                renderMovement(room);
            } else {
                messageAreaEl.textContent = 'Sbagliato! Hai attivato una trappola!';
                loseLife();
                if (room.puzzle.singleTry && player.lives > 0) {
                    // Special case for room 16: one wrong answer is instant game over
                    triggerGameOver();
                }
                puzzleInputEl.value = '';
                puzzleInputEl.focus();
            }
        }

        function triggerGameOver() {
            player.gameOver = true;
            gameWrapperEl.style.display = 'none';
            gameOverScreenEl.style.display = 'block';
        }

        function triggerVictory() {
            player.gameOver = true;
            gameWrapperEl.style.display = 'none';
            victoryScreenEl.style.display = 'block';
        }

        function init() {
            // Attach event listeners
            moveButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const direction = btn.dataset.dir;
                    const nextRoomId = gameData[player.currentRoom].connections[direction];
                    renderRoom(nextRoomId);
                });
            });

            submitBtn.addEventListener('click', handleSubmitPuzzle);
            puzzleInputEl.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    handleSubmitPuzzle();
                }
            });

            // Start the game
            renderRoom(player.currentRoom);
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
```